# 雅思学习智能体 实施方案（v1.0）

## 0. 目标与范围

- **总体目标**：交付一个可运行的雅思学习智能体，支持听/说/读/写训练与评估，具备合规的数据与模型治理、明确的SLO与运维体系。
- **首期MVP**（优先闭环）：口语全真模拟 + 自动评分 + 可操作改进清单 + 7天训练计划。
  - 端到端延迟（P95）：ASR < 1.5s；评分 < 2s；总 < 3s。
  - 评分一致性：与人工考官加权Kappa/Quadratic Weighted Kappa ≥ 0.80。
  - 用户价值：一键模拟 + 即时报告 + 分层训练建议 + 次日复练提醒。

## 1. 里程碑与时间线（12 周）

- 第1-2周：需求冻结与MVP细化；选型与成本测算；数据与合规方案确定。
- 第3-4周：系统骨架搭建（服务划分、接口骨架、身份与存储）、ASR/TTS联通。
- 第5-6周：口语MVP实现（Part1/2/3流程、计时、录音、转写、初版评分与报告）。
- 第7-8周：评分标定与评测集搭建；QWK≥0.8 达标；用户画像与建议生成优化。
- 第9-10周：监控与LLMOps、缓存与成本控制、国际化与无障碍要点落地。
- 第11周：封版测试（性能/稳态/异常注入/合规检查），灰度/小流量试运行。
- 第12周：发布与复盘；下期功能排期（阅读题型矩阵、写作Task1/2细化）。

## 2. 架构与组件

- 客户端（移动/Web）：
  - 口语MVP页：题库、计时器、录音/回放、实时转写字幕、分段评分显示、建议卡片。
  - 学习仪表盘：能力雷达、进度、7天训练计划、错题/错误短语库。
- 网关与鉴权：API网关、JWT/OAuth2、速率限制、AB标记。
- 领域服务：
  - `speaking-service`：会话编排（Part1/2/3）、计时与录音、ASR联动、评分请求、报告生成。
  - `scoring-service`：口语四维评分（流利连贯、词汇、语法、发音）与解释生成。
  - `asr-service`：语音识别适配层（云/本地），噪声抑制、断句、时间戳。
  - `tts-service`：示范音频与反馈朗读；多语种/多音色适配。
  - `user-profile-service`：能力画像与弱项聚合；训练计划调度。
  - `content-service`：合规模版与仿真题；口语卡片、话题库、同义替换库。
  - `review-service`：人审与申诉闭环；样本回流与再标定队列。
- 数据与存储：
  - Postgres（事务数据与画像）、S3/OSS（音频与报告）、Redis（会话/缓存）、OpenSearch（检索）。
- 监控与运维：
  - 指标（Prometheus）、日志（ELK/ClickHouse）、追踪（OpenTelemetry）、特征与评测看板（Grafana）。

## 3. 技术选型

- ASR：优先云服务（延迟与口音覆盖好），可选 Whisper-large-v3-turbo（离线备选）。
- TTS：云TTS（多音色/高自然度），必要时本地轻量TTS兜底。
- 评分与NLG：主力LLM（可商用合规的GPT-4o/Claude/或国产合规大模型），配合小模型做要素抽取与一致性校验。
- 后端：Python FastAPI；任务编排与异步（Celery/Arq + Redis）；流式传输（WebSocket）。
- 前端：Web（React/Next.js）与移动（Flutter/React Native 二选一）。

## 4. MVP 范围与用例（口语）

- Part 1：常规问答，限制轮数与时长；即时转写；作答后生成简短建议。
- Part 2：1分钟准备 + 1-2分钟陈述；展示卡片关键词；结束后分维度建议。
- Part 3：追问深度1-2层；话题拓展与批判性思维提示。
- 报告：四维分数、长短处摘要、可操作清单（词汇替换/句式升级/连贯性连接词/发音练习建议），附关键片段转写与时间戳定位。
- 训练计划：基于弱项生成7天计划（每日15-20分钟），含具体任务与素材链接。

## 5. 接口与数据模型（示例）

- 鉴权
  - POST `/auth/login` -> { token }
- 会话编排
  - POST `/speaking/session` -> { sessionId, topic, parts }
  - POST `/speaking/session/{id}/part/{n}/start`
  - POST `/speaking/session/{id}/audio` (stream) -> { asrPartial, timestamps }
  - POST `/speaking/session/{id}/finish` -> { transcriptId }
- 评分与报告
  - POST `/scoring/speaking` { transcriptId, audioUrl, meta } -> { scores:{FC,LR,GR,PR}, overall, rationales[], actionItems[], highlights[] }
  - GET `/report/{sessionId}` -> { summary, scores, suggestions, plan7d }
- 画像与计划
  - GET `/profile/me` -> { radar, history, weaknesses }
  - POST `/plan/7d` { weaknesses } -> { day1..day7 tasks[] }

数据模型（关键字段）：
- Transcript: { id, sessionId, asrText, wordTimestamps[], segments[], lang=en, wpm, pauseRate, fillerCount }
- Score: { id, sessionId, FC, LR, GR, PR, overall, conf, rubricVersion, modelVersion }
- ActionItem: { id, sessionId, type, before, after, examples[], practiceLink }
- UserProfile: { id, bands:{L,R,W,S}, skills:{fc,lr,gr,pr}, history[], weaknesses[] }

## 6. 评分与标定（口语）

- 指标定义：对齐官方Band Descriptors（Fluency & Coherence, Lexical Resource, Grammatical Range & Accuracy, Pronunciation）。
- 评测集：多考官双盲打分集（≥500样本，覆盖不同口音与话题难度）。
- 指标：QWK、皮尔逊相关、MAE（回归到Band）；分布一致性检验；置信区间展示。
- 校准：等分回归 + 温度缩放（或Platt）以稳定Band离散化；灰度上线前后对照。
- 漂移监控：上线后按周抽检再标注；阈值外自动降级为“建议型反馈”，收敛后恢复打分。

## 7. 内容与版权合规

- 题库：不使用未授权真题；采用授权内容与自建仿真题；保留可追溯来源与许可记录。
- 生成内容：范文/音频标注“AI生成”与时间戳；事实性风险提示与引用链路。
- 用户数据使用：作文/录音用于模型优化需显式选择加入；随时可撤回；数据导出/删除能力。

## 8. 安全与隐私

- 数据分级与脱敏：音频与文本分区存储；静态/传输加密（KMS），访问审计。
- 最小权限与密钥管理：短期凭证、服务到服务的mTLS；Secrets集中管理。
- 合规：遵循所在地法律（含GDPR/本地），制定保留/删除策略与DPIA文档。

## 9. 监控、LLMOps 与成本控制

- 监控：
  - 延迟：ASR、评分、端到端；可用性；错误率；缓存命中；单用户速率。
  - 质量：评分与人工一致性在线抽检；幻觉/不当内容拦截率；用户满意度（CSAT）。
- LLMOps：
  - 提示模板版本化、A/B实验、自动回归评测；离线对齐集；在线回放。
  - 失败重试策略与幂等；多模型路由与降级（小模型摘要 + 大模型复核）。
- 成本：
  - Prompt与上下文裁剪；Embedding缓存；结果缓存（score/report）；批处理与并发控制。
  - 月度成本看板：单会话成本、模块占比、峰谷策略。

## 10. 前端产品要点

- 口语考试模式：全屏沉浸、计时器、卡片关键词、进度条、弱提醒（勿打断）。
- 实时字幕：逐词高亮与时间轴回放；一键定位高风险片段（长停顿/连读问题）。
- 报告页面：分维度评分卡、重点片段引用、建议清单、一天一练按钮。
- 无障碍/国际化：字幕开关、键盘无障碍、色盲安全配色、中英双语切换。

## 11. 风险与缓解

- 评分不稳/QWK未达标：扩大评测集、引入人审闭环、使用校准与置信阈值门控。
- 口音/噪声导致ASR误差：麦克风检测与噪声提示、门限内重录、模型多样性与自适应推理。
- 成本超标：缓存与批处理、生效的降级策略、限速与队列。
- 合规风险：题库严格授权、用户许可透明、审计与DPIA留档。

## 12. 交付物与验收

- 可运行系统：Web端最小实现 + 后端服务 + 监控看板。
- 文档：API文档、数据字典、评分标定报告、合规与DPIA、运维手册。
- 验收：
  - 性能：端到端P95<3s；可用性≥99.9%。
  - 质量：QWK≥0.8；报告建议被≥70%用户评价为“有用”。
  - 合规：数据/版权/隐私检查通过。

---
文档版本：v1.0  最后更新：2025-11-04

